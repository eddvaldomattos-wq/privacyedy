<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Integra√ß√£o SyncPayments</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #F58170, #F9AF77);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            background: #f8f9fa;
        }

        .test-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #1e7e34;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-warning:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background: #117a8b;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .log-container {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-success {
            background: #28a745;
        }

        .status-error {
            background: #dc3545;
        }

        .status-warning {
            background: #ffc107;
        }

        .status-info {
            background: #17a2b8;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 14px;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #007bff;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .card h4 {
            color: #495057;
            margin-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }

        .alert {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #6c757d;
            border-top: 1px solid #e9ecef;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß™ Teste Integra√ß√£o SyncPayments</h1>
            <p>Interface completa para testar todas as funcionalidades da API</p>
        </div>

        <div class="content">
            <!-- Status da Integra√ß√£o -->
            <div class="test-section">
                <h3><span class="status-indicator status-info"></span>Status da Integra√ß√£o</h3>
                <div id="integration-status">
                    <p>Verificando status da integra√ß√£o...</p>
                </div>
                <div class="button-group">
                    <button class="btn btn-info" onclick="checkIntegrationStatus()">
                        üîç Verificar Status
                    </button>
                    <button class="btn btn-success" onclick="initializeIntegration()">
                        üöÄ Inicializar
                    </button>
                </div>
            </div>

            <!-- Autentica√ß√£o -->
            <div class="test-section">
                <h3><span class="status-indicator status-warning"></span>1. Autentica√ß√£o</h3>
                <p>Teste a autentica√ß√£o com a API SyncPayments</p>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="testAuthentication()">
                        üîê Autenticar
                    </button>
                    <button class="btn btn-info" onclick="checkTokenStatus()">
                        üîç Verificar Token
                    </button>
                    <button class="btn btn-danger" onclick="clearToken()">
                        üóëÔ∏è Limpar Token
                    </button>
                </div>
                <div id="auth-result"></div>
            </div>

            <!-- Consulta de Saldo -->
            <div class="test-section">
                <h3><span class="status-indicator status-info"></span>2. Consulta de Saldo</h3>
                <p>Consulte o saldo atual da conta</p>
                <div class="button-group">
                    <button class="btn btn-success" onclick="testBalance()">
                        üí∞ Consultar Saldo
                    </button>
                </div>
                <div id="balance-result"></div>
            </div>

            <!-- Cash-in -->
            <div class="test-section">
                <h3><span class="status-indicator status-warning"></span>3. Cash-in (Dep√≥sito PIX)</h3>
                <p>Crie uma transa√ß√£o de dep√≥sito via PIX</p>
                
                <div class="grid">
                    <div class="card">
                        <h4>Dados do Cliente</h4>
                        <div class="form-group">
                            <label for="client-name">Nome Completo</label>
                            <input type="text" id="client-name" value="Jo√£o Silva Teste" placeholder="Nome completo">
                        </div>
                        <div class="form-group">
                            <label for="client-cpf">CPF</label>
                            <input type="text" id="client-cpf" value="12345678901" placeholder="12345678901" maxlength="11">
                        </div>
                        <div class="form-group">
                            <label for="client-email">Email</label>
                            <input type="email" id="client-email" value="joao.teste@exemplo.com" placeholder="email@exemplo.com">
                        </div>
                        <div class="form-group">
                            <label for="client-phone">Telefone</label>
                            <input type="text" id="client-phone" value="11987654321" placeholder="11987654321" maxlength="11">
                        </div>
                    </div>
                    
                    <div class="card">
                        <h4>Dados da Transa√ß√£o</h4>
                        <div class="form-group">
                            <label for="amount">Valor (R$)</label>
                            <input type="number" id="amount" value="10.00" step="0.01" min="0.01">
                        </div>
                        <div class="form-group">
                            <label for="description">Descri√ß√£o</label>
                            <input type="text" id="description" value="Teste de integra√ß√£o - Cash-in" placeholder="Descri√ß√£o da transa√ß√£o">
                        </div>
                        <div class="form-group">
                            <label for="user-id">User ID (Split)</label>
                            <input type="text" id="user-id" value="708ddc0b-357d-4548-b158-615684caa616" placeholder="UUID do usu√°rio">
                        </div>
                        <div class="form-group">
                            <label for="percentage">Percentage (%)</label>
                            <input type="number" id="percentage" value="100" min="1" max="100">
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-warning" onclick="testCashIn()">
                        üí≥ Criar Cash-in
                    </button>
                    <button class="btn btn-info" onclick="testCashInWithValidation()">
                        ‚úÖ Criar com Valida√ß√£o
                    </button>
                </div>
                <div id="cashin-result"></div>
            </div>

            <!-- Consulta de Status -->
            <div class="test-section">
                <h3><span class="status-indicator status-info"></span>4. Consulta de Status</h3>
                <p>Consulte o status de uma transa√ß√£o espec√≠fica</p>
                <div class="form-group">
                    <label for="transaction-id">ID da Transa√ß√£o</label>
                    <input type="text" id="transaction-id" placeholder="Digite o ID da transa√ß√£o ou deixe vazio para usar a √∫ltima">
                </div>
                <div class="button-group">
                    <button class="btn btn-info" onclick="testTransactionStatus()">
                        üîç Consultar Status
                    </button>
                    <button class="btn btn-success" onclick="monitorTransaction()">
                        üìä Monitorar Transa√ß√£o
                    </button>
                </div>
                <div id="status-result"></div>
            </div>

            <!-- Teste Completo -->
            <div class="test-section">
                <h3><span class="status-indicator status-success"></span>5. Teste Completo</h3>
                <p>Execute todos os testes em sequ√™ncia</p>
                <div class="button-group">
                    <button class="btn btn-danger" onclick="runCompleteTest()">
                        üéØ Executar Teste Completo
                    </button>
                    <button class="btn btn-info" onclick="runStressTest()">
                        ‚ö° Teste de Stress
                    </button>
                </div>
                <div id="complete-test-result"></div>
            </div>

            <!-- Logs -->
            <div class="test-section">
                <h3><span class="status-indicator status-info"></span>üìã Logs de Execu√ß√£o</h3>
                <div class="button-group">
                    <button class="btn btn-info" onclick="clearLogs()">
                        üóëÔ∏è Limpar Logs
                    </button>
                    <button class="btn btn-success" onclick="exportLogs()">
                        üì• Exportar Logs
                    </button>
                </div>
                <div id="logs" class="log-container">Aguardando execu√ß√£o de testes...</div>
            </div>
        </div>

        <div class="footer">
            <p>üß™ Teste Integra√ß√£o SyncPayments v1.0.0 | Desenvolvido com ‚ù§Ô∏è</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/syncpay-integration.js"></script>
    
    <script>
        // Vari√°veis globais
        let lastTransactionId = null;
        let testResults = [];

        // Fun√ß√£o para adicionar logs
        function addLog(message, type = 'info') {
            const logs = document.getElementById('logs');
            const timestamp = new Date().toLocaleString('pt-BR');
            const emoji = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            const logEntry = `[${timestamp}] ${emoji} ${message}\n`;
            logs.textContent = logEntry + logs.textContent;
        }

        // Fun√ß√£o para mostrar resultado
        function showResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            const alertClass = type === 'error' ? 'alert-danger' : type === 'success' ? 'alert-success' : 'alert-info';
            element.innerHTML = `<div class="alert ${alertClass}">${message}</div>`;
        }

        // Verificar status da integra√ß√£o
        function checkIntegrationStatus() {
            addLog('Verificando status da integra√ß√£o...');
            
            const status = document.getElementById('integration-status');
            const hasConfig = window.SYNCPAY_CONFIG && window.SYNCPAY_CONFIG.client_id && window.SYNCPAY_CONFIG.client_secret;
            const hasIntegration = window.SyncPayIntegration;
            
            let statusHtml = '<div class="grid">';
            
            // Status da configura√ß√£o
            statusHtml += '<div class="card">';
            statusHtml += '<h4>Configura√ß√£o</h4>';
            if (hasConfig) {
                statusHtml += '<p style="color: #28a745;">‚úÖ Configura√ß√£o carregada</p>';
                statusHtml += `<p><strong>Client ID:</strong> ${window.SYNCPAY_CONFIG.client_id.substring(0, 20)}...</p>`;
            } else {
                statusHtml += '<p style="color: #dc3545;">‚ùå Configura√ß√£o n√£o encontrada</p>';
            }
            statusHtml += '</div>';
            
            // Status da integra√ß√£o
            statusHtml += '<div class="card">';
            statusHtml += '<h4>Integra√ß√£o</h4>';
            if (hasIntegration) {
                statusHtml += '<p style="color: #28a745;">‚úÖ SyncPayIntegration carregada</p>';
                statusHtml += '<p><strong>Fun√ß√µes dispon√≠veis:</strong> getAuthToken, getBalance, createCashIn, getTransactionStatus</p>';
            } else {
                statusHtml += '<p style="color: #dc3545;">‚ùå SyncPayIntegration n√£o encontrada</p>';
            }
            statusHtml += '</div>';
            
            statusHtml += '</div>';
            status.innerHTML = statusHtml;
            
            addLog('Status verificado com sucesso');
        }

        // Inicializar integra√ß√£o
        async function initializeIntegration() {
            addLog('Inicializando integra√ß√£o...');
            try {
                await window.SyncPayIntegration.getAuthToken();
                addLog('Integra√ß√£o inicializada com sucesso', 'success');
                showResult('integration-status', '‚úÖ Integra√ß√£o inicializada e autenticada com sucesso!', 'success');
            } catch (error) {
                addLog(`Erro ao inicializar: ${error.message}`, 'error');
                showResult('integration-status', `‚ùå Erro ao inicializar: ${error.message}`, 'error');
            }
        }

        // Testar autentica√ß√£o
        async function testAuthentication() {
            addLog('Iniciando teste de autentica√ß√£o...');
            try {
                const token = await window.SyncPayIntegration.getAuthToken();
                addLog('Autentica√ß√£o bem-sucedida', 'success');
                showResult('auth-result', `‚úÖ Autentica√ß√£o realizada com sucesso!<br>Token: ${token.substring(0, 50)}...`, 'success');
            } catch (error) {
                addLog(`Erro na autentica√ß√£o: ${error.message}`, 'error');
                showResult('auth-result', `‚ùå Erro na autentica√ß√£o: ${error.message}`, 'error');
            }
        }

        // Verificar status do token
        function checkTokenStatus() {
            addLog('Verificando status do token...');
            const isValid = window.SyncPayIntegration.isTokenValid();
            if (isValid) {
                addLog('Token v√°lido', 'success');
                showResult('auth-result', '‚úÖ Token v√°lido e ativo', 'success');
            } else {
                addLog('Token inv√°lido ou expirado', 'warning');
                showResult('auth-result', '‚ö†Ô∏è Token inv√°lido ou expirado', 'warning');
            }
        }

        // Limpar token
        function clearToken() {
            addLog('Limpando token...');
            // Como o token est√° em mem√≥ria, recarregamos a p√°gina
            location.reload();
        }

        // Testar consulta de saldo
        async function testBalance() {
            addLog('Iniciando consulta de saldo...');
            try {
                const balance = await window.SyncPayIntegration.getBalance();
                addLog('Saldo consultado com sucesso', 'success');
                showResult('balance-result', `‚úÖ Saldo consultado: R$ ${balance.balance || 'N/A'}`, 'success');
            } catch (error) {
                addLog(`Erro ao consultar saldo: ${error.message}`, 'error');
                showResult('balance-result', `‚ùå Erro ao consultar saldo: ${error.message}`, 'error');
            }
        }

        // Testar cash-in
        async function testCashIn() {
            addLog('Iniciando cria√ß√£o de cash-in...');
            
            const cashInData = {
                amount: parseFloat(document.getElementById('amount').value),
                description: document.getElementById('description').value,
                client: {
                    name: document.getElementById('client-name').value,
                    cpf: document.getElementById('client-cpf').value,
                    email: document.getElementById('client-email').value,
                    phone: document.getElementById('client-phone').value
                },
                split: [
                    {
                        percentage: parseInt(document.getElementById('percentage').value),
                        user_id: document.getElementById('user-id').value
                    }
                ]
            };

            try {
                const result = await window.SyncPayIntegration.createCashIn(cashInData);
                lastTransactionId = result.identifier;
                addLog('Cash-in criado com sucesso', 'success');
                showResult('cashin-result', `‚úÖ Cash-in criado com sucesso!<br>ID: ${result.identifier}<br>Status: ${result.status}`, 'success');
            } catch (error) {
                addLog(`Erro ao criar cash-in: ${error.message}`, 'error');
                showResult('cashin-result', `‚ùå Erro ao criar cash-in: ${error.message}`, 'error');
            }
        }

        // Testar cash-in com valida√ß√£o
        async function testCashInWithValidation() {
            addLog('Iniciando cash-in com valida√ß√£o...');
            
            // Valida√ß√µes b√°sicas
            const amount = parseFloat(document.getElementById('amount').value);
            const cpf = document.getElementById('client-cpf').value;
            const phone = document.getElementById('client-phone').value;
            const email = document.getElementById('client-email').value;
            
            if (amount <= 0) {
                addLog('Valor deve ser maior que zero', 'error');
                showResult('cashin-result', '‚ùå Valor deve ser maior que zero', 'error');
                return;
            }
            
            if (cpf.length !== 11 || !/^\d+$/.test(cpf)) {
                addLog('CPF deve ter 11 d√≠gitos num√©ricos', 'error');
                showResult('cashin-result', '‚ùå CPF deve ter 11 d√≠gitos num√©ricos', 'error');
                return;
            }
            
            if (phone.length < 10 || phone.length > 11 || !/^\d+$/.test(phone)) {
                addLog('Telefone deve ter 10 ou 11 d√≠gitos num√©ricos', 'error');
                showResult('cashin-result', '‚ùå Telefone deve ter 10 ou 11 d√≠gitos num√©ricos', 'error');
                return;
            }
            
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                addLog('Email inv√°lido', 'error');
                showResult('cashin-result', '‚ùå Email inv√°lido', 'error');
                return;
            }
            
            // Se passou pelas valida√ß√µes, criar cash-in
            await testCashIn();
        }

        // Testar consulta de status
        async function testTransactionStatus() {
            addLog('Iniciando consulta de status...');
            
            const transactionId = document.getElementById('transaction-id').value || lastTransactionId;
            
            if (!transactionId) {
                addLog('Nenhum ID de transa√ß√£o fornecido', 'warning');
                showResult('status-result', '‚ö†Ô∏è Nenhum ID de transa√ß√£o fornecido. Crie um cash-in primeiro.', 'warning');
                return;
            }
            
            try {
                const status = await window.SyncPayIntegration.getTransactionStatus(transactionId);
                addLog('Status consultado com sucesso', 'success');
                showResult('status-result', `‚úÖ Status consultado:<br>ID: ${status.identifier}<br>Status: ${status.status}<br>Valor: R$ ${status.amount}`, 'success');
            } catch (error) {
                addLog(`Erro ao consultar status: ${error.message}`, 'error');
                showResult('status-result', `‚ùå Erro ao consultar status: ${error.message}`, 'error');
            }
        }

        // Monitorar transa√ß√£o
        async function monitorTransaction() {
            addLog('Iniciando monitoramento de transa√ß√£o...');
            
            const transactionId = document.getElementById('transaction-id').value || lastTransactionId;
            
            if (!transactionId) {
                addLog('Nenhum ID de transa√ß√£o fornecido', 'warning');
                showResult('status-result', '‚ö†Ô∏è Nenhum ID de transa√ß√£o fornecido. Crie um cash-in primeiro.', 'warning');
                return;
            }
            
            let attempts = 0;
            const maxAttempts = 10;
            
            const monitor = async () => {
                attempts++;
                addLog(`Tentativa ${attempts}/${maxAttempts} - Monitorando transa√ß√£o ${transactionId}...`);
                
                try {
                    const status = await window.SyncPayIntegration.getTransactionStatus(transactionId);
                    
                    if (status.status === 'completed') {
                        addLog('Transa√ß√£o completada!', 'success');
                        showResult('status-result', `üéâ Transa√ß√£o completada!<br>ID: ${status.identifier}<br>Valor: R$ ${status.amount}`, 'success');
                        return;
                    } else if (status.status === 'expired') {
                        addLog('Transa√ß√£o expirada', 'warning');
                        showResult('status-result', '‚è∞ Transa√ß√£o expirada', 'warning');
                        return;
                    } else {
                        addLog(`Status atual: ${status.status}`);
                        
                        if (attempts < maxAttempts) {
                            setTimeout(monitor, 5000); // Verificar a cada 5 segundos
                        } else {
                            addLog('Tempo limite de monitoramento atingido', 'warning');
                            showResult('status-result', '‚è∞ Tempo limite de monitoramento atingido', 'warning');
                        }
                    }
                } catch (error) {
                    addLog(`Erro ao monitorar: ${error.message}`, 'error');
                    if (attempts < maxAttempts) {
                        setTimeout(monitor, 5000);
                    }
                }
            };
            
            monitor();
        }

        // Executar teste completo
        async function runCompleteTest() {
            addLog('üöÄ Iniciando teste completo...');
            
            try {
                // 1. Autentica√ß√£o
                addLog('1Ô∏è‚É£ Etapa 1: Autentica√ß√£o');
                await window.SyncPayIntegration.getAuthToken();
                addLog('‚úÖ Autentica√ß√£o OK', 'success');
                
                // 2. Consultar saldo
                addLog('2Ô∏è‚É£ Etapa 2: Consulta de saldo');
                const balance = await window.SyncPayIntegration.getBalance();
                addLog(`‚úÖ Saldo consultado: R$ ${balance.balance || 'N/A'}`, 'success');
                
                // 3. Criar cash-in
                addLog('3Ô∏è‚É£ Etapa 3: Cria√ß√£o de cash-in');
                const cashInData = {
                    amount: 5.00,
                    description: 'Teste completo - Integra√ß√£o SyncPayments',
                    client: {
                        name: 'Maria Silva Teste',
                        cpf: '98765432100',
                        email: 'maria.teste@exemplo.com',
                        phone: '11876543210'
                    },
                    split: [
                        { percentage: 100, user_id: '708ddc0b-357d-4548-b158-615684caa616' }
                    ]
                };
                
                const cashInResult = await window.SyncPayIntegration.createCashIn(cashInData);
                lastTransactionId = cashInResult.identifier;
                addLog(`‚úÖ Cash-in criado: ${cashInResult.identifier}`, 'success');
                
                // 4. Consultar status
                addLog('4Ô∏è‚É£ Etapa 4: Consulta de status');
                const status = await window.SyncPayIntegration.getTransactionStatus(cashInResult.identifier);
                addLog(`‚úÖ Status consultado: ${status.status}`, 'success');
                
                addLog('üéâ Teste completo executado com sucesso!', 'success');
                showResult('complete-test-result', 'üéâ Teste completo executado com sucesso! Todas as funcionalidades est√£o funcionando corretamente.', 'success');
                
            } catch (error) {
                addLog(`‚ùå Erro no teste completo: ${error.message}`, 'error');
                showResult('complete-test-result', `‚ùå Erro no teste completo: ${error.message}`, 'error');
            }
        }

        // Teste de stress
        async function runStressTest() {
            addLog('‚ö° Iniciando teste de stress...');
            
            const testCount = 5;
            let successCount = 0;
            let errorCount = 0;
            
            for (let i = 1; i <= testCount; i++) {
                addLog(`Teste ${i}/${testCount} - Criando cash-in...`);
                
                try {
                    const cashInData = {
                        amount: 1.00,
                        description: `Teste de stress ${i}`,
                        client: {
                            name: `Cliente Teste ${i}`,
                            cpf: '12345678901',
                            email: `teste${i}@exemplo.com`,
                            phone: '11987654321'
                        },
                        split: [
                            { percentage: 100, user_id: '708ddc0b-357d-4548-b158-615684caa616' }
                        ]
                    };
                    
                    await window.SyncPayIntegration.createCashIn(cashInData);
                    successCount++;
                    addLog(`‚úÖ Teste ${i} bem-sucedido`, 'success');
                } catch (error) {
                    errorCount++;
                    addLog(`‚ùå Teste ${i} falhou: ${error.message}`, 'error');
                }
                
                // Aguardar 1 segundo entre os testes
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            
            addLog(`üìä Resultado do teste de stress: ${successCount} sucessos, ${errorCount} falhas`, 'info');
            showResult('complete-test-result', `üìä Teste de stress conclu√≠do:<br>‚úÖ Sucessos: ${successCount}<br>‚ùå Falhas: ${errorCount}`, successCount > errorCount ? 'success' : 'warning');
        }

        // Limpar logs
        function clearLogs() {
            document.getElementById('logs').textContent = 'Logs limpos...';
            addLog('Logs limpos pelo usu√°rio');
        }

        // Exportar logs
        function exportLogs() {
            const logs = document.getElementById('logs').textContent;
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `syncpay-logs-${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            addLog('Logs exportados com sucesso', 'success');
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            addLog('P√°gina de teste carregada');
            checkIntegrationStatus();
        });
    </script>
</body>
</html>
